<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>login</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <div class="main">
        <div id="background"></div>
        <div class="navbar">
            <img class="LOGO">
        </div>
        <div class="login">
            <img class="LOGO">
            <div>
                <form id="login-form">
                    <input class="in" type="text" placeholder="用户名" id="username" required>
                    <input class="in" type="password" placeholder="密码" id="password" required>
                    <button class = "in" type="submit" onclick="getVegalite(event)">用户名登录</button>
                </form>
                <p class="message" id="verification-message"></p>

                <p class = "account" id="text">没有账号？</p>
                <a href="../sign-up/sign-up.html" class = "account" id="sign-up">注册账号</a>
                <a href="../reset-password/reset-password.html" class = "account" id="forget-password">忘记密码</a>
                <div class="container">
                    <div class="item line" id="line-one"></div>
                    <div class="item para" ><p>或者</p></div>
                    <div class="item line" id="line-two"></div>
                </div>
                <button onclick="RedirectToPage()" class = "in" type="button">使用邮箱登录</button>
                <script>
                    function getVegalite(event) {
                        event.preventDefault();
                        var username = document.getElementById("username").value;
                        var password = document.getElementById("password").value;
                        // 创建一个新的AJAX请求对象
                        var xhr = new XMLHttpRequest();

                        // 配置请求
                        xhr.open('GET', 'http://localhost:8080/login?username='+username+"&password="+password); // 根据您的实际需求指定适当的URL
                        xhr.setRequestHeader('Content-Type', 'application/json');
                        // 定义处理响应的函数
                        xhr.onload = function() {
                            if (xhr.status === 200) {
                                var response = xhr.responseText;
                                var jsonResult=JSON.parse(response);
                                var message = document.getElementById("verification-message");
                                message.textContent = jsonResult.message;
                                message.style.color = "green";
                                window.location.href = "../../index.html";
                            } else {
                                var message = document.getElementById("verification-message");
                                message.textContent = "发送不成功";
                                message.style.color = "red";
                                alert('请求失败。错误代码：' + xhr.status);
                            }
                        };

                        xhr.send();
                    }
                    function RedirectToPage() {
                        window.location.href = "email-login.html";
                    }
                    document.getElementById("login-form").addEventListener("submit", getVegalite);
                </script>
            </div>
        </div>
    </div>
</body>
</html>
